@using Gui.Events
@using Gui.Models
@inject IEventService EventService


<div class="list-container">
    @foreach (var book in books)
    {
        <div class="book-card">
            <div class="book-cover">
                <img src="@book.ImageUrl" alt="@book.Title book cover"/>
                <div class="book-description">@book.Description</div>
            </div>
            <div class="book-info">
                <p class="book-title">@book.Title</p>
                <div class="book-author-rating">
                    <span>@book.Author</span>
                    <p class="book-rating">
                        @($"{book.Rating:F1}") <i class="fas fa-star"></i>
                    </p>
                </div>
                <div class="book-tags">
                    @foreach (var tag in book.Tags)
                    {
                        <div class="tag-chip">@tag</div>
                    }
                </div>
            </div>
        </div>
    }
</div>

@code {

    private IEnumerable<BookCard> books =
    [
        new BookCard("Author 1", "Title 1", "This is the longest description you are ever going to need, I'm I not correct?. This is the longest description you are ever going to need, I'm I not correct.This is the longest description you are ever going to need, I'm I not correct.This is the longest description you are ever going to need, I'm I not correct.This is the longest description you are ever going to need, I'm I not correct.This is the longest description you are ever going to need, I'm I not correct.This is the longest description you are ever going to need, I'm I not correct", 2001, 2.3f, "cover0.jpeg", "url1", ["tag1", "tag2"]),
        new BookCard("Author 2", "Title 2", "Description 2", 2002, 2.3f, "cover1.jpeg", "url1", ["tag1", "tag2"]),
        new BookCard("Author 3", "Title 3", "Description 3", 3002, 2.3f, "cover2.jpeg", "url1", ["tag1", "tag2"]),
        new BookCard("Author 4", "Title 4", "Description 4", 4002, 2.3f, "cover3.jpeg", "url1", ["tag1", "tag2"]),
    ];

    protected override void OnInitialized()
    {
        EventService.OnQuerySearch += HandleQuerySearch;
    }

    private void HandleQuerySearch(string query)
    {
        Console.WriteLine("List: " + query);
    }

    public void Dispose()
    {
        EventService.OnQuerySearch -= HandleQuerySearch;
    }

}